<a href="https://kaio6fellipe.github.io/"><img src="./images/back-home.png" alt="Home Page" width="50" height="58" style="filter: grayscale(100%)"></a> 

# Information
> I end up wasting a lot of time doing long and detailed scans with nmap, but in the end they were needed.
>
> To get rid of this problem, I needed to be very accurate with what I was supposed to scan. A good way to speed up this process would be to extract a list of open ports and then scan these ports with the full scan to get all the details that I needed.
>
> To do this, run masscan, get the list of open ports, and run a full scan with nmap. If masscan has a problem, run nmap's fast scan, get the list of open ports, and run a full scan later. See [Details](#details) and [Example](#example) to see how it works with this code.

# Configuration
Install some Python packages:
```shell
pip install netifaces
```
```shell
pip install python-nmap
```
```shell
pip install python-masscan
```
# Details

The [python_masscan.py](./python_masscan.py) file contains 1 usable function:
- masscanProcess
  - This function receives a string with the host IP or DNS
  - The scan will start executing this argument in masscan : ``` --max-rate 1000 --adpter-ip (your ip) ```
  - When the scan is finished, some information will be displayed on the screen
  - This function will return the dictionary generated by the scan and a string containing all the open ports in the host separated with a comma

The [python_nmap.py](./python_nmap.py) file contains 3 usable functions:
- nmapFastScanProcess
  - This function receives a string with the host IP or DNS
  - The scan will start executing this argument in nmap: ``` -A -T5 ```
  - When the scan is finished, some information will be displayed on the screen
  - This function will return the dictionary generated by the scan and a string containing all the open ports in the host separated with a comma
- nmapCompleteScanProcess
  - This function receives two strings with the host IP or DNS and a port list 
  - The scan will start executing this argument in nmap: ``` -p (port_list) -O -sT -sV -sC -A -T5 ```
  - When the scan is finished, some information will be displayed on the screen
  - This function will return the dictionary generated by the scan
- nmapCustomScanProcess
  - This function receives 3 parameters, 1 host IP or DNS, 1 string with the custom nmap argument and 1 port to scan
  - The scan will start executing the following argument ``` -p (port) (custom argument) ```
  - This function will return the dictionary generated by the scan and an summary dictionary, with the main information extracted

# Example

I usually use these functions like that:

```python
import python_masscan
import python_nmap

# Setting the target
host = '192.168.0.120'

# Try, Except to execute masscan first, if it fails for some reason, execute nmap fast scan instead
try:
    # Extracting the dictionary and the list of ports from the masscan module
    scan_ms, port_list_ms = python_masscan.masscanProcess(host)
    # Extracting the dictionary from the nmap module, passing the port list from the masscan module
    complete_scan = python_nmap.nmapCompleteScanProcess(host, port_list_ms)
except:
    # Extracting the dicionary and the list os ports from the nmap module
    scan_nm, port_list_nm = python_nmap.nmapFastScanProcess(host)
    # Extracting the dictionary from the nmap module, passing the port list from the nmap module
    complete_scan = python_nmap.nmapCompleteScanProcess(host, port_list_nm)

# Printing the dictionary
print(complete_scan)
```
This example will generate the following output after the scan that I did on the metasploitable machine:
```json
{
   "this-json": "looks awesome..."
}
```
